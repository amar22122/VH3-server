name: Minecraft Server

on:
  workflow_dispatch:
  push:
    branches: [ "main" ]

jobs:
  start-server:
    runs-on: ubuntu-latest

    steps:
      - name: تثبيت المتطلبات
        run: |
          sudo apt update
          sudo apt install -y unzip curl python3-pip
          pip install gdown

      - name: تحميل السيرفر من Google Drive
        run: |
          gdown 1PLIX6xT-05RWA76Y-31sBmiqNTMmlhGQ -O server.zip

      - name: فك ضغط ملف السيرفر
        run: unzip server.zip -d server

      - name: تشغيل Playit.gg
        run: |
          curl -o playit.zip https://playit-cloud.github.io/cli/playit-linux.zip
          unzip playit.zip
          chmod +x playit
          ./playit &

      - name: تشغيل السيرفر
        working-directory: ./server
        run: |
          chmod +x *.sh || true
          chmod +x *.jar || true
          java -Xms2G -Xmx4G -jar forge-*.jar nogui
